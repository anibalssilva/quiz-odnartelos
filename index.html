<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Quiz - Descobrir e Soletrar Palavra</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/annyang/2.6.1/annyang.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    #consoantes {
      font-size: 2em;
      margin-bottom: 20px;
    }
    input[type="text"] {
      font-size: 1.2em;
      padding: 5px;
      margin: 5px;
      width: 300px;
      text-align: center;
    }
    #letrasFaladas {
      font-size: 2em;
      margin: 15px auto;
      min-height: 40px;
      border: 1px solid #ccc;
      width: 300px;
      padding: 10px;
      letter-spacing: 10px;
    }
    button {
      font-size: 1.1em;
      padding: 8px 15px;
      margin: 10px 5px;
      cursor: pointer;
    }
    #resultado {
      margin-top: 20px;
      font-size: 1.3em;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h1>Descubra a Palavra e Soletre de Tr√°s para Frente!</h1>

  <div id="consoantes"></div>

  <div>
    <input type="text" id="palavraDigitada" placeholder="Digite a palavra completa" />
  </div>

  <div id="letrasFaladas"></div>

  <div>
    <button onclick="verificarPalavraDigitada()">üìù Verificar Palavra</button>
    <button onclick="iniciarReconhecimento()">üé§ Falar Letra</button>
    <button onclick="pararReconhecimento()">üõë Parar Voz</button>
    <button onclick="verificarSoletracao()">‚úÖ Verificar Soletra√ß√£o</button>
    <button onclick="apagarUltimaLetra()">üóëÔ∏è Apagar √öltima Letra</button>
    <button onclick="pularPalavra()">‚û°Ô∏è Pular Palavra</button>
  </div>

  <div id="resultado"></div>

  <audio id="somAcerto" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="somErro" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>

  <script>
    const palavras = [
      "ENGENHARIA", "HOMOLOGADO", "DESLUMBRAR", "RETROVISOR", "COMPONENTE", "LAVANDERIA",
      "DISSIMULADO", "FACULTATIVO", "HOSTILIDADE", "VERTIGINOSO", "TRAVESSEIRO", "INTERRUPTOR",
      "DESUMANIDADE", "INSATISFEITO", "EMBORRACHADO", "ESCRIVANINHA", "FLEXIBILIDADE", "SUBJETIVIDADE",
      "COMPORTAMENTO", "CONTRAPARTIDA", "DESPRETENSIOSO", "PERFECCIONISTA", "EXTRACURRICULAR",
      "FUNDAMENTALISMO", "LAVOURA", "TIRANIA", "CATARSE", "DESPESA", "REPULSA", "SUBLIME"
    ];

    let palavraEscolhida = "";
    let letrasFaladas = [];

    function removerVogais(palavra) {
      return palavra.replace(/[AEIOU]/gi, '');
    }

    function carregarNovaPalavra() {
      const indice = Math.floor(Math.random() * palavras.length);
      palavraEscolhida = palavras[indice];
      document.getElementById('consoantes').textContent = removerVogais(palavraEscolhida);
      document.getElementById('palavraDigitada').value = "";
      letrasFaladas = [];
      atualizarCampoLetras();
      document.getElementById('resultado').textContent = "";
    }

    function atualizarCampoLetras() {
      document.getElementById('letrasFaladas').textContent = letrasFaladas.join('');
    }

    function iniciarReconhecimento() {
      if (annyang) {
        const comandos = {
          '*letra': function(letra) {
            letra = letra.toUpperCase().replace(/[^A-Z]/g, '');
            if (letra.length > 0) {
              letrasFaladas.push(letra[0]);
              atualizarCampoLetras();
            }
          }
        };
        annyang.removeCommands();
        annyang.addCommands(comandos);
        annyang.setLanguage('pt-BR');
        annyang.start({ autoRestart: true, continuous: true });
      } else {
        alert("Reconhecimento de voz n√£o suportado.");
      }
    }

    function pararReconhecimento() {
      if (annyang) {
        annyang.abort();
      }
    }

    function verificarPalavraDigitada() {
      const palavraDigitada = document.getElementById('palavraDigitada').value.trim().toUpperCase();
      const resultadoDiv = document.getElementById('resultado');

      if (palavraDigitada === palavraEscolhida) {
        resultadoDiv.textContent = "‚úÖ Palavra correta! Agora soletre de tr√°s para frente!";
        resultadoDiv.style.color = "green";
        document.getElementById('somAcerto').play();
      } else {
        resultadoDiv.textContent = "‚ùå Palavra errada!";
        resultadoDiv.style.color = "red";
        document.getElementById('somErro').play();
      }
    }

    function verificarSoletracao() {
      const palavraEsperadaInvertida = palavraEscolhida.split('').reverse().join('');
      const palavraMontada = letrasFaladas.join('');
      const resultadoDiv = document.getElementById('resultado');

      if (palavraMontada === palavraEsperadaInvertida) {
        resultadoDiv.textContent = "üéâ Parab√©ns! Voc√™ soletrou corretamente!";
        resultadoDiv.style.color = "green";
        document.getElementById('somAcerto').play();
        setTimeout(() => carregarNovaPalavra(), 3000);
      } else {
        resultadoDiv.textContent = "‚ùå Erro na soletra√ß√£o!";
        resultadoDiv.style.color = "red";
        document.getElementById('somErro').play();
      }
    }

    function apagarUltimaLetra() {
      letrasFaladas.pop();
      atualizarCampoLetras();
    }

    function pularPalavra() {
      carregarNovaPalavra();
      pararReconhecimento();
    }

    carregarNovaPalavra();
  </script>

</body>
</html>
